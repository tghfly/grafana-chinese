/*! For license information please see default~DashboardPage~SoloPanelPage.5c3edd1990e1c7cf41f1.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"7iUX":function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("kDLi"),i=n("Obii"),c=n("kDDq");function s(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n        margin-left: 16px;\n      "]);return s=function(){return e},e}t.a=function(e){var t=function(e){switch(e){case i.PluginState.alpha:return"Alpha Plugin: This plugin is a work in progress and updates may include breaking changes";case i.PluginState.beta:return"Beta Plugin: There could be bugs and minor breaking changes to this plugin"}return null}(e.state);return t?o.a.createElement(a.AlphaNotice,{state:e.state,text:t,className:Object(c.css)(s())}):null}},"8M//":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("UvM7"),o=n("NXk7"),a=n("3SGO"),i=n("UIT+"),c=n("KyLG"),s=n("GQ3c"),u=n("rd46"),l=n("ZFWI"),p=n("M/8g"),f=n("+CPp");function d(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){d(a,r,o,i,c,"next",e)}function c(e){d(a,r,o,i,c,"throw",e)}i(void 0)}))}}function m(e,t,n){return h.apply(this,arguments)}function h(){return(h=b(regeneratorRuntime.mark((function e(t,n,r){var c,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.getDashboardBySlug(t);case 2:(c=e.sent)&&(s=c.meta.url,-1!==r.indexOf("dashboard-solo")&&(s=s.replace("/d/","/d-solo/")),u=i.b.stripBaseFromUrl(s),n(Object(a.c)({path:u,partial:!0,replace:!0})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t,n){return g.apply(this,arguments)}function g(){return(g=b(regeneratorRuntime.mark((function e(t,n,r){var u,l,p,f,d,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=t.routeInfo,e.next=e.t0===s.DashboardRouteInfo.Home?4:e.t0===s.DashboardRouteInfo.Normal?15:e.t0===s.DashboardRouteInfo.New?29:30;break;case 4:return e.next=6,o.b.get("/api/dashboards/home");case 6:if(!(u=e.sent).redirectUri){e.next=11;break}return l=i.b.stripBaseFromUrl(u.redirectUri),n(Object(a.c)({path:l,replace:!0})),e.abrupt("return",null);case 11:return u.meta.canSave=!1,u.meta.canShare=!1,u.meta.canStar=!1,e.abrupt("return",u);case 15:if("db"!==t.urlType){e.next=18;break}return m(t.urlSlug,n,r().location.path),e.abrupt("return",null);case 18:return p=t.$injector.get("dashboardLoaderSrv"),e.next=21,p.loadDashboard(t.urlType,t.urlSlug,t.urlUid);case 21:if(f=e.sent,!t.fixUrl||!f.meta.url){e.next=28;break}if(d=i.b.stripBaseFromUrl(f.meta.url),b=r().location.path,d===b){e.next=28;break}return n(Object(a.c)({path:d,partial:!0,replace:!0})),e.abrupt("return",null);case 28:return e.abrupt("return",f);case 29:return e.abrupt("return",O(t.urlFolderId));case 30:throw{message:"Unknown route "+t.routeInfo};case 31:e.next=38;break;case 33:return e.prev=33,e.t1=e.catch(0),n(Object(c.f)({message:"Failed to fetch dashboard",error:e.t1})),console.log(e.t1),e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,null,[[0,33]])})))).apply(this,arguments)}function v(e){return function(){var t=b(regeneratorRuntime.mark((function t(n,o){var i,s,d,b,m,h,g,v,O,w,S,j,P,k,C,x,T;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Object(c.g)()),setTimeout((function(){null===o().dashboard.getModel()&&n(Object(c.i)())}),500),t.next=4,y(e,n,o);case 4:if(i=t.sent){t.next=7;break}return t.abrupt("return");case 7:n(Object(c.h)()),t.prev=8,s=new u.a(i.dashboard,i.meta),t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(8),n(Object(c.f)({message:"Failed create dashboard model",error:t.t0})),console.log(t.t0),t.abrupt("return");case 17:if((d=o()).location.query.orgId||n(Object(a.c)({query:{orgId:d.user.orgId},partial:!0,replace:!0})),b=e.$injector.get("timeSrv"),m=e.$injector.get("annotationsSrv"),h=e.$injector.get("variableSrv"),g=e.$injector.get("keybindingSrv"),v=e.$injector.get("unsavedChangesSrv"),O=e.$injector.get("dashboardSrv"),b.init(s),m.init(s),d.dashboard.modifiedQueries&&(w=d.dashboard.modifiedQueries,S=w.panelId,j=w.queries,s.meta.fromExplore=!(!S||!j)),t.prev=28,Object(l.c)().featureToggles.newVariables){t.next=32;break}return t.next=32,h.init(s);case 32:if(!Object(l.c)().featureToggles.newVariables){t.next=38;break}return P=s.variables.list.length>0?s.variables.list:s.templating.list.filter((function(e){return f.a.contains(e.type)})),t.next=36,n(Object(p.a)(P));case 36:return t.next=38,n(Object(p.b)());case 38:t.next=44;break;case 40:t.prev=40,t.t1=t.catch(28),n(Object(a.b)(Object(r.a)("Templating init failed",t.t1))),console.log(t.t1);case 44:try{s.processRepeats(),s.updateSubmenuVisibility(),(k=o().location.query).autofitpanels&&s.autoFitPanels(window.innerHeight,k.kiosk),v.init(s,e.$scope),g.setupDashboardBindings(e.$scope,s)}catch(e){n(Object(a.b)(Object(r.a)("Dashboard init failed",e))),console.log(e)}d.dashboard.modifiedQueries&&(C=d.dashboard.modifiedQueries,x=C.panelId,T=C.queries,E(n,s,x,T)),O.setCurrent(s),n(Object(c.e)(s));case 48:case"end":return t.stop()}}),t,null,[[8,12],[28,40]])})));return function(e,n){return t.apply(this,arguments)}}()}function O(e){var t={meta:{canStar:!1,canShare:!1,isNew:!0,folderId:0},dashboard:{title:"New dashboard",panels:[{type:"add-panel",gridPos:{x:0,y:0,w:12,h:9},title:"Panel Title"}]}};return e&&(t.meta.folderId=parseInt(e,10)),t}function E(e,t,n,r){var o=t.panels.findIndex((function(e){return e.id===n}));o>-1&&(t.panels[o].targets=r),e(Object(c.d)())}},EGoX:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("ZFWI"),i=n("TSYQ"),c=n.n(i),s=o.a.memo((function(e){var t=e.isCurrent,n=e.plugin,r=e.onClick,a=c()({"viz-picker__item":!0,"viz-picker__item--current":t});return o.a.createElement("div",{className:a,onClick:r,title:n.name},o.a.createElement("div",{className:"viz-picker__item-name"},n.name),o.a.createElement("img",{className:"viz-picker__item-img",src:n.info.logos.small}))}),(function(e,t){return e.isCurrent===t.isCurrent})),u=n("kDLi");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return m}));var m=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,d(t).call(this,e))).pluginList=n.getPanelPlugins,n.renderVizPlugin=function(e,t){var r=n.props.onTypeChange,a=e.id===n.props.current.id;return o.a.createElement(s,{key:e.id,isCurrent:a,plugin:e,onClick:function(){return r(e)}})},n.getFilteredPluginList=function(){var e=n.props.searchQuery,t=new RegExp(e,"i");return n.pluginList.filter((function(e){return t.test(e.name)}))},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.getFilteredPluginList(),n=t.length>0;return o.a.createElement("div",{className:"viz-picker"},o.a.createElement("div",{className:"viz-picker-list"},n?t.map((function(t,n){return e.renderVizPlugin(t,n)})):o.a.createElement(u.EmptySearchResult,null,"Could not find anything matching your query")))}},{key:"maxSelectedIndex",get:function(){return this.getFilteredPluginList().length-1}},{key:"getPanelPlugins",get:function(){var e=a.b.panels;return Object.keys(e).filter((function(t){return!1===e[t].hideFromList})).map((function(t){return e[t]})).sort((function(e,t){return e.sort-t.sort}))}}])&&p(n.prototype,r),i&&p(n,i),t}(r.PureComponent)},EKT6:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("q1tI"),o=n.n(r),a=n("Obii"),i=Object(r.forwardRef)((function(e,t){return o.a.createElement("label",{className:e.labelClassName},o.a.createElement("input",{ref:t,type:"text",className:e.inputClassName,value:Object(a.unEscapeStringFromRegex)(e.value),onChange:function(t){return e.onChange(Object(a.escapeStringForRegex)(t.target.value))},placeholder:e.placeholder?e.placeholder:null}),o.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))}))},"GP+p":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("q1tI"),o=n.n(r),a=n("kDLi"),i=n("9LhM");function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=p(this,f(t).call(this,e))).onToggleToolBarView=function(e){n.setState({openView:e,isOpen:n.state.openView!==e||!n.state.isOpen})},n.onCloseOpenView=function(){n.setState({isOpen:!1})},n.state={openView:null,fadeIn:!1,isOpen:!1},n}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,c=[{key:"getDerivedStateFromProps",value:function(e,t){if(t.openView){var n=e.toolbarItems.find((function(e){return e.title===t.openView.title&&e.icon===t.openView.icon}));if(n)return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{openView:n})}return t}}],(r=[{key:"componentDidMount",value:function(){this.setState({fadeIn:!0})}},{key:"renderButton",value:function(e){var t=this;return o.a.createElement("div",{className:"nav-buttons",key:e.title+e.icon},o.a.createElement("button",{className:"btn navbar-button",onClick:function(){e.onClick&&e.onClick(),e.render&&t.onToggleToolBarView(e)},disabled:e.disabled},e.icon&&o.a.createElement("i",{className:e.icon})," ",e.title))}},{key:"renderOpenView",value:function(e){return o.a.createElement(a.PanelOptionsGroup,{title:e.title||e.heading,onClose:this.onCloseOpenView},e.render())}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.renderToolbar,c=t.heading,s=t.toolbarItems,u=t.scrollTop,l=t.setScrollTop,p=this.state,f=p.openView,d=p.fadeIn,b=p.isOpen;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"toolbar"},o.a.createElement("div",{className:"toolbar__left"},o.a.createElement("div",{className:"toolbar__heading"},c),r&&r()),s.map((function(t){return e.renderButton(t)}))),o.a.createElement("div",{className:"panel-editor__scroll"},o.a.createElement(a.CustomScrollbar,{autoHide:!1,scrollTop:u,setScrollTop:l,updateAfterMountMs:300},o.a.createElement("div",{className:"panel-editor__content"},o.a.createElement(i.a,{in:b,duration:200,unmountOnExit:!0},f&&this.renderOpenView(f)),o.a.createElement(i.a,{in:d,duration:50},n)))))}}])&&l(n.prototype,r),c&&l(n,c),t}(r.PureComponent);b.defaultProps={toolbarItems:[]}},I1OQ:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n("xL/7"),o=n("3SGO");function a(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,s,"next",e)}function s(e){a(i,r,o,c,s,"throw",e)}c(void 0)}))}}var c=function(e){return function(){var t=i(regeneratorRuntime.mark((function t(n,o){var a,i,c,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=o().panelEditor.activeTab||r.a.Queries,i=e.hasQueriesTab,c=e.usesGraphPlugin,s=e.alertingEnabled,u=[Object(r.b)(r.a.Queries),Object(r.b)(r.a.Visualization),Object(r.b)(r.a.Advanced)],i||(u.shift(),a===r.a.Queries&&(a=r.a.Visualization)),s&&c&&u.push(Object(r.b)(r.a.Alert)),n(Object(r.d)({activeTab:a,tabs:u}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},s=function(e){return function(){var t=i(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(Object(o.c)({query:{tab:e.id,openVizPicker:null},partial:!0}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Nznp:function(e,t,n){var r,o;window,e.exports=(r=n("q1tI"),o=n("i8i4"),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){e.exports=n(11)()},function(e,t,n){"use strict";function r(e,t){for(var n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]}function o(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)}function a(e){return"number"==typeof e&&!isNaN(e)}function i(e){return parseInt(e,10)}function c(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))}n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c}))},function(e,t,n){"use strict";var r=n(1),o=["Moz","Webkit","O","ms"];function a(e,t){return t?"".concat(t).concat(function(e){for(var t="",n=!0,r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):"-"===e[r]?n=!0:t+=e[r];return t}(e)):e}var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window||void 0===window.document)return"";var t=window.document.documentElement.style;if(e in t)return"";for(var n=0;n<o.length;n++)if(a(e,o[n])in t)return o[n];return""}();function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"i",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"m",(function(){return d})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return y})),n.d(t,"j",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return S})),n.d(t,"b",(function(){return j})),n.d(t,"n",(function(){return P})),n.d(t,"o",(function(){return k}));var u="";function l(e,t){return u||(u=Object(r.b)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(t){return Object(r.d)(e[t])}))),!!Object(r.d)(e[u])&&e[u](t)}function p(e,t,n){var r=e;do{if(l(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function f(e,t,n){e&&(e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener?e.addEventListener(t,n,!0):e["on"+t]=n)}function d(e,t,n){e&&(e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener?e.removeEventListener(t,n,!0):e["on"+t]=null)}function b(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=Object(r.c)(n.borderTopWidth))+Object(r.c)(n.borderBottomWidth)}function m(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=Object(r.c)(n.borderLeftWidth))+Object(r.c)(n.borderRightWidth)}function h(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=Object(r.c)(n.paddingTop))-Object(r.c)(n.paddingBottom)}function y(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=Object(r.c)(n.paddingLeft))-Object(r.c)(n.paddingRight)}function g(e,t){var n=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:e.clientX+t.scrollLeft-n.left,y:e.clientY+t.scrollTop-n.top}}function v(e,t){var n=E(e,t,"px");return s({},a("transform",i),n)}function O(e,t){return E(e,t,"")}function E(e,t,n){var r=e.x,o=e.y,a="translate(".concat(r).concat(n,",").concat(o).concat(n,")");if(t){var i="".concat("string"==typeof t.x?t.x:t.x+n),c="".concat("string"==typeof t.y?t.y:t.y+n);a="translate(".concat(i,", ").concat(c,")")+a}return a}function w(e,t){return e.targetTouches&&Object(r.b)(e.targetTouches,(function(e){return t===e.identifier}))||e.changedTouches&&Object(r.b)(e.changedTouches,(function(e){return t===e.identifier}))}function S(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0}function j(e){if(e){var t,n,r=e.getElementById("react-draggable-style-el");r||((r=e.createElement("style")).type="text/css",r.id="react-draggable-style-el",r.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",r.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(r)),e.body&&(n="react-draggable-transparent-selection",(t=e.body).classList?t.classList.add(n):t.className.match(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)")))||(t.className+=" ".concat(n)))}}function P(e){try{e&&e.body&&(t=e.body,n="react-draggable-transparent-selection",t.classList?t.classList.remove(n):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)"),"g"),"")),e.selection?e.selection.empty():window.getSelection().removeAllRanges()}catch(e){}var t,n}function k(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({touchAction:"none"},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d}));var r=n(1),o=n(6),a=n.n(o),i=n(2);function c(e,t,n){if(!e.props.bounds)return[t,n];var o=e.props.bounds;o="string"==typeof o?o:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(o);var a=b(e);if("string"==typeof o){var c,s=a.ownerDocument,u=s.defaultView;if(!((c="parent"===o?a.parentNode:s.querySelector(o))instanceof u.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');var l=u.getComputedStyle(a),p=u.getComputedStyle(c);o={left:-a.offsetLeft+Object(r.c)(p.paddingLeft)+Object(r.c)(l.marginLeft),top:-a.offsetTop+Object(r.c)(p.paddingTop)+Object(r.c)(l.marginTop),right:Object(i.h)(c)-Object(i.l)(a)-a.offsetLeft+Object(r.c)(p.paddingRight)-Object(r.c)(l.marginRight),bottom:Object(i.g)(c)-Object(i.k)(a)-a.offsetTop+Object(r.c)(p.paddingBottom)-Object(r.c)(l.marginBottom)}}return Object(r.e)(o.right)&&(t=Math.min(t,o.right)),Object(r.e)(o.bottom)&&(n=Math.min(n,o.bottom)),Object(r.e)(o.left)&&(t=Math.max(t,o.left)),Object(r.e)(o.top)&&(n=Math.max(n,o.top)),[t,n]}function s(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]}function u(e){return"both"===e.props.axis||"x"===e.props.axis}function l(e){return"both"===e.props.axis||"y"===e.props.axis}function p(e,t,n){var r="number"==typeof t?Object(i.e)(e,t):null;if("number"==typeof t&&!r)return null;var o=b(n),a=n.props.offsetParent||o.offsetParent||o.ownerDocument.body;return Object(i.j)(r||e,a)}function f(e,t,n){var o=e.state,a=!Object(r.e)(o.lastX),i=b(e);return a?{node:i,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:i,deltaX:t-o.lastX,deltaY:n-o.lastY,lastX:o.lastX,lastY:o.lastY,x:t,y:n}}function d(e,t){var n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}}function b(e){var t=a.a.findDOMNode(e);if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}},function(e,t,n){"use strict";function r(){}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n(5),o=n.n(r),a=n(0),i=n.n(a),c=n(6),s=n.n(c),u=n(2),l=n(3),p=n(1),f=n(4);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O={start:"touchstart",move:"touchmove",stop:"touchend"},E={start:"mousedown",move:"mousemove",stop:"mouseup"},w=E,S=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=h(t)).call.apply(e,[this].concat(i)),n=!o||"object"!==d(o)&&"function"!=typeof o?y(r):o,v(y(n),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),v(y(n),"handleDragStart",(function(e){if(n.props.onMouseDown(e),!n.props.allowAnyClick&&"number"==typeof e.button&&0!==e.button)return!1;var t=s.a.findDOMNode(y(n));if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var r=t.ownerDocument;if(!(n.props.disabled||!(e.target instanceof r.defaultView.Node)||n.props.handle&&!Object(u.i)(e.target,n.props.handle,t)||n.props.cancel&&Object(u.i)(e.target,n.props.cancel,t))){var o=Object(u.f)(e);n.setState({touchIdentifier:o});var a=Object(l.f)(e,o,y(n));if(null!=a){var i=a.x,c=a.y,p=Object(l.c)(y(n),i,c);Object(f.a)("DraggableCore: handleDragStart: %j",p),Object(f.a)("calling",n.props.onStart),!1!==n.props.onStart(e,p)&&(n.props.enableUserSelectHack&&Object(u.b)(r),n.setState({dragging:!0,lastX:i,lastY:c}),Object(u.a)(r,w.move,n.handleDrag),Object(u.a)(r,w.stop,n.handleDragStop))}}})),v(y(n),"handleDrag",(function(e){"touchmove"===e.type&&e.preventDefault();var t=Object(l.f)(e,n.state.touchIdentifier,y(n));if(null!=t){var r=t.x,o=t.y;if(Array.isArray(n.props.grid)){var a=r-n.state.lastX,i=o-n.state.lastY,c=b(Object(l.g)(n.props.grid,a,i),2);if(a=c[0],i=c[1],!a&&!i)return;r=n.state.lastX+a,o=n.state.lastY+i}var s=Object(l.c)(y(n),r,o);if(Object(f.a)("DraggableCore: handleDrag: %j",s),!1!==n.props.onDrag(e,s))n.setState({lastX:r,lastY:o});else try{n.handleDragStop(new MouseEvent("mouseup"))}catch(e){var u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.handleDragStop(u)}}})),v(y(n),"handleDragStop",(function(e){if(n.state.dragging){var t=Object(l.f)(e,n.state.touchIdentifier,y(n));if(null!=t){var r=t.x,o=t.y,a=Object(l.c)(y(n),r,o),i=s.a.findDOMNode(y(n));i&&n.props.enableUserSelectHack&&Object(u.n)(i.ownerDocument),Object(f.a)("DraggableCore: handleDragStop: %j",a),n.setState({dragging:!1,lastX:NaN,lastY:NaN}),n.props.onStop(e,a),i&&(Object(f.a)("DraggableCore: Removing handlers"),Object(u.m)(i.ownerDocument,w.move,n.handleDrag),Object(u.m)(i.ownerDocument,w.stop,n.handleDragStop))}}})),v(y(n),"onMouseDown",(function(e){return w=E,n.handleDragStart(e)})),v(y(n),"onMouseUp",(function(e){return w=E,n.handleDragStop(e)})),v(y(n),"onTouchStart",(function(e){return w=O,n.handleDragStart(e)})),v(y(n),"onTouchEnd",(function(e){return w=O,n.handleDragStop(e)})),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillUnmount",value:function(){var e=s.a.findDOMNode(this);if(e){var t=e.ownerDocument;Object(u.m)(t,E.move,this.handleDrag),Object(u.m)(t,O.move,this.handleDrag),Object(u.m)(t,E.stop,this.handleDragStop),Object(u.m)(t,O.stop,this.handleDragStop),this.props.enableUserSelectHack&&Object(u.n)(t)}}},{key:"render",value:function(){return o.a.cloneElement(o.a.Children.only(this.props.children),{style:Object(u.o)(this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}])&&m(n.prototype,r),t}();v(S,"displayName","DraggableCore"),v(S,"propTypes",{allowAnyClick:i.a.bool,disabled:i.a.bool,enableUserSelectHack:i.a.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:i.a.arrayOf(i.a.number),handle:i.a.string,cancel:i.a.string,onStart:i.a.func,onDrag:i.a.func,onStop:i.a.func,onMouseDown:i.a.func,className:p.a,style:p.a,transform:p.a}),v(S,"defaultProps",{allowAnyClick:!1,cancel:null,disabled:!1,enableUserSelectHack:!0,offsetParent:null,handle:null,grid:null,transform:null,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){}})},function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var i=o.apply(null,r);i&&e.push(i)}else if("object"===a)for(var c in r)n.call(r,c)&&r[c]&&e.push(c)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r=n(10).default;e.exports=r,e.exports.default=r,e.exports.DraggableCore=n(7).default},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var r=n(5),o=n.n(r),a=n(0),i=n.n(a),c=n(6),s=n.n(c),u=n(8),l=n.n(u),p=n(2),f=n(3),d=n(1),b=n(7),m=n(4);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=function(e){function t(e){var n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=O(t).call(this,e),n=!r||"object"!==h(r)&&"function"!=typeof r?E(this):r,P(E(n),"onDragStart",(function(e,t){if(Object(m.a)("Draggable: onDragStart: %j",t),!1===n.props.onStart(e,Object(f.d)(E(n),t)))return!1;n.setState({dragging:!0,dragged:!0})})),P(E(n),"onDrag",(function(e,t){if(!n.state.dragging)return!1;Object(m.a)("Draggable: onDrag: %j",t);var r=Object(f.d)(E(n),t),o={x:r.x,y:r.y};if(n.props.bounds){var a=o.x,i=o.y;o.x+=n.state.slackX,o.y+=n.state.slackY;var c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(f.e)(E(n),o.x,o.y),2),s=c[0],u=c[1];o.x=s,o.y=u,o.slackX=n.state.slackX+(a-o.x),o.slackY=n.state.slackY+(i-o.y),r.x=o.x,r.y=o.y,r.deltaX=o.x-n.state.x,r.deltaY=o.y-n.state.y}if(!1===n.props.onDrag(e,r))return!1;n.setState(o)})),P(E(n),"onDragStop",(function(e,t){if(!n.state.dragging)return!1;if(!1===n.props.onStop(e,Object(f.d)(E(n),t)))return!1;Object(m.a)("Draggable: onDragStop: %j",t);var r={dragging:!1,slackX:0,slackY:0};if(Boolean(n.props.position)){var o=n.props.position,a=o.x,i=o.y;r.x=a,r.y=i}n.setState(r)})),n.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:v({},e.position),slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,o.a.Component),S(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.position,r=t.prevPropsPosition;return!n||r&&n.x===r.x&&n.y===r.y?null:(Object(m.a)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:r}),{x:n.x,y:n.y,prevPropsPosition:v({},n)})}}]),S(t,[{key:"componentDidMount",value:function(){void 0!==window.SVGElement&&s.a.findDOMNode(this)instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"render",value:function(){var e,t=this.props,n=(t.axis,t.bounds,t.children),r=t.defaultPosition,a=t.defaultClassName,i=t.defaultClassNameDragging,c=t.defaultClassNameDragged,s=t.position,u=t.positionOffset,d=(t.scale,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"])),m={},h=null,g=!Boolean(s)||this.state.dragging,O=s||r,E={x:Object(f.a)(this)&&g?this.state.x:O.x,y:Object(f.b)(this)&&g?this.state.y:O.y};this.state.isElementSVG?h=Object(p.d)(E,u):m=Object(p.c)(E,u);var w=l()(n.props.className||"",a,(P(e={},i,this.state.dragging),P(e,c,this.state.dragged),e));return o.a.createElement(b.default,y({},d,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),o.a.cloneElement(o.a.Children.only(n),{className:w,style:v({},n.props.style,{},m),transform:h}))}}]),t}();P(k,"displayName","Draggable"),P(k,"propTypes",v({},b.default.propTypes,{axis:i.a.oneOf(["both","x","y","none"]),bounds:i.a.oneOfType([i.a.shape({left:i.a.number,right:i.a.number,top:i.a.number,bottom:i.a.number}),i.a.string,i.a.oneOf([!1])]),defaultClassName:i.a.string,defaultClassNameDragging:i.a.string,defaultClassNameDragged:i.a.string,defaultPosition:i.a.shape({x:i.a.number,y:i.a.number}),positionOffset:i.a.shape({x:i.a.oneOfType([i.a.number,i.a.string]),y:i.a.oneOfType([i.a.number,i.a.string])}),position:i.a.shape({x:i.a.number,y:i.a.number}),className:d.a,style:d.a,transform:d.a})),P(k,"defaultProps",v({},b.default.defaultProps,{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},position:null,scale:1}))},function(e,t,n){"use strict";var r=n(12);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,a,i){if(i!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}]))},"OG+f":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("q1tI"),o=n.n(r),a=n("Obii"),i=n("t8hP");function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){var e,n;s(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(n=l(this,(e=p(t)).call.apply(e,[this].concat(o)))).state={isError:!1,isLoading:!1,help:""},n.loadHelp=function(){var e=n.props,t=e.plugin,r=e.type;n.setState({isLoading:!0}),Object(i.getBackendSrv)().get("/api/plugins/".concat(t.id,"/markdown/").concat(r)).then((function(e){var t=Object(a.renderMarkdown)(e);""===e&&"help"===r?n.setState({isError:!1,isLoading:!1,help:n.constructPlaceholderInfo()}):n.setState({isError:!1,isLoading:!1,help:t})})).catch((function(){n.setState({isError:!0,isLoading:!1})}))},n}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.loadHelp()}},{key:"constructPlaceholderInfo",value:function(){return"No plugin help or readme markdown file was found"}},{key:"render",value:function(){this.props.type;var e=this.state,t=e.isError,n=e.isLoading,r=e.help;return n?o.a.createElement("h2",null,"Loading help..."):t?o.a.createElement("h3",null,"'Error occurred when loading help'"):o.a.createElement("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:r}})}}])&&u(n.prototype,r),c&&u(n,c),t}(r.PureComponent)},Yuww:function(e,t,n){"use strict";var r,o=n("q1tI"),a=n.n(o),i=n("TSYQ"),c=n.n(i),s=n("jYz7"),u=n("/MKj"),l=n("LvDl"),p=n("kDLi"),f=n("1gCF"),d=n("Obii"),b=n("t8hP"),m=n("5kRJ"),h=n("NPB1"),y=n("kt0J");function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e){e.Error="Error",e.Info="Info",e.Links="Links"}(r||(r={}));var j=function(e){function t(){var e,n;v(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=E(this,(e=w(t)).call.apply(e,[this].concat(i)))).timeSrv=Object(h.a)(),n.getInfoMode=function(){var e=n.props,t=e.panel;return e.error?r.Error:t.description?r.Info:t.links&&t.links.length?r.Links:void 0},n.getInfoContent=function(){var e=n.props.panel,t=e.description||"",r=m.b.replace(t,e.scopedVars),o=Object(d.renderMarkdown)(r),i=n.props.links&&n.props.links.getLinks(e);return a.a.createElement("div",{className:"panel-info-content markdown-html"},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:o}}),i&&i.length>0&&a.a.createElement("ul",{className:"panel-info-corner-links"},i.map((function(e,t){return a.a.createElement("li",{key:t},a.a.createElement("a",{className:"panel-info-corner-links__item",href:e.href,target:e.target},e.title))}))))},n.onClickError=function(){Object(b.getLocationSrv)().update({partial:!0,query:{inspect:n.props.panel.id,tab:y.a.Error}})},n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,e),n=t,(o=[{key:"renderCornerType",value:function(e,t,n){var o=e===r.Error?"error":"info";return a.a.createElement(p.Tooltip,{content:t,placement:"top-start",theme:o},a.a.createElement("div",{className:"panel-info-corner panel-info-corner--".concat(e.toLowerCase()),onClick:n},a.a.createElement("i",{className:"fa"}),a.a.createElement("span",{className:"panel-info-corner-inner"})))}},{key:"render",value:function(){var e=this.props.error,t=this.getInfoMode();return t?t===r.Error&&e?this.renderCornerType(t,e,this.onClickError):t===r.Info||t===r.Links?this.renderCornerType(t,this.getInfoContent):null:null}}])&&O(n.prototype,o),i&&O(n,i),t}(o.Component),P=function(e){var t="submenu"===e.type;return"divider"===e.type?a.a.createElement("li",{className:"divider"}):a.a.createElement("li",{className:t?"dropdown-submenu":void 0},a.a.createElement("a",{onClick:e.onClick,href:e.href},e.iconClassName&&a.a.createElement("i",{className:e.iconClassName}),a.a.createElement("span",{className:"dropdown-item-text","aria-label":f.a.pages.Dashboard.Panels.Panel.selectors.headerItems(e.text)},e.text),e.shortcut&&a.a.createElement("span",{className:"dropdown-menu-item-shortcut"},e.shortcut)),e.children)};function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var N=function(e){function t(){var e,n;C(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=T(this,(e=_(t)).call.apply(e,[this].concat(o)))).renderItems=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.a.createElement("ul",{className:"dropdown-menu dropdown-menu--menu panel-menu",role:t?"":"menu"},e.map((function(e,t){return a.a.createElement(P,{key:"".concat(e.text).concat(t),type:e.type,text:e.text,iconClassName:e.iconClassName,onClick:e.onClick,shortcut:e.shortcut},e.subMenu&&n.renderItems(e.subMenu,!0))})))},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return a.a.createElement("div",{className:"panel-menu-container dropdown open"},this.renderItems(this.props.items))}}])&&x(n.prototype,r),o&&x(n,o),t}(o.PureComponent),M=n("MAcC"),I=n("3SGO"),R=n("iODs"),L=n("ZFWI"),q=n("+JUD"),A=n("umNM"),F=n("Efza"),V=n("m257");function Q(e,t,n){var r=[];r.push({text:"视图",iconClassName:"gicon gicon-viewer",onClick:function(e){e.preventDefault(),R.d.dispatch(Object(I.c)({query:{panelId:t.id,edit:null,fullscreen:!0},partial:!0}))},shortcut:"v"}),e.canEditPanel(t)&&r.push({text:"编辑",iconClassName:"gicon gicon-editor",onClick:function(e){e.preventDefault(),R.d.dispatch(Object(I.c)({query:{panelId:t.id,edit:!0,fullscreen:!0},partial:!0}))},shortcut:"e"}),r.push({text:"分享",iconClassName:"fa fa-fw fa-share",onClick:function(n){n.preventDefault(),Object(q.f)(e,t)},shortcut:"p s"}),A.a.hasAccessToExplore()&&!t.plugin.meta.skipDataQuery&&r.push({text:"探索",iconClassName:"gicon gicon-explore",shortcut:"x",onClick:function(e){e.preventDefault();var n=e.ctrlKey||e.metaKey?function(e){return window.open(e)}:void 0;R.d.dispatch(Object(F.l)(t,{getDataSourceSrv:b.getDataSourceSrv,getTimeSrv:h.a,getExploreUrl:V.k,openInNewWindow:n}))}}),L.b.featureToggles.inspect&&r.push({text:"检查",iconClassName:"fa fa-fw fa-info-circle",onClick:function(e){e.preventDefault(),Object(b.getLocationSrv)().update({partial:!0,query:{inspect:t.id}})},shortcut:"p i"}),L.b.featureToggles.newEdit&&r.push({text:"新编辑",iconClassName:"gicon gicon-editor",onClick:function(e){e.preventDefault(),R.d.dispatch(Object(I.c)({query:{editPanel:t.id},partial:!0}))},shortcut:"p i"});var o=[];return!t.fullscreen&&e.canEditPanel(t)&&(o.push({text:"克隆",onClick:function(n){n.preventDefault(),Object(q.c)(e,t)},shortcut:"p d"}),o.push({text:"复制",onClick:function(e){e.preventDefault(),Object(q.b)(t)}})),o.push({text:"面板JSON",onClick:function(n){n.preventDefault(),Object(q.d)(e,t)}}),n&&function(){var e=n.getScope(),t=e.$$childHead.ctrl,r=t.getExtendedMenu(),a=!0,i=!1,c=void 0;try{for(var s,u=function(){var n=s.value,r={text:n.text,href:n.href,shortcut:n.shortcut};n.click&&(r.onClick=function(){e.$eval(n.click,{ctrl:t})}),o.push(r)},l=r[Symbol.iterator]();!(a=(s=l.next()).done);a=!0)u()}catch(e){i=!0,c=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw c}}}(),r.push({type:"submenu",text:"更多...",iconClassName:"fa fa-fw fa-cube",subMenu:o,onClick:function(e){e.preventDefault()}}),e.canEditPanel(t)&&(r.push({type:"divider"}),r.push({text:"删除",iconClassName:"fa fa-fw fa-trash",onClick:function(n){n.preventDefault(),Object(q.e)(e,t,!0)},shortcut:"p r"})),r}function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=function(e){function t(){var e,n;H(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=B(this,(e=W(t)).call.apply(e,[this].concat(o)))).clickCoordinates={x:0,y:0},n.state={panelMenuOpen:!1,menuItems:[]},n.eventToClickCoordinates=function(e){return{x:e.clientX,y:e.clientY}},n.onMouseDown=function(e){n.clickCoordinates=n.eventToClickCoordinates(e)},n.isClick=function(e){return Object(l.isEqual)(e,n.clickCoordinates)},n.onMenuToggle=function(e){if(n.isClick(n.eventToClickCoordinates(e))){e.stopPropagation();var t=n.props,r=Q(t.dashboard,t.panel,t.angularComponent);n.setState({panelMenuOpen:!n.state.panelMenuOpen,menuItems:r})}},n.closeMenu=function(){n.setState({panelMenuOpen:!1})},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,e),n=t,(r=[{key:"renderLoadingState",value:function(){return a.a.createElement("div",{className:"panel-loading"},a.a.createElement("i",{className:"fa fa-spinner fa-spin"}))}},{key:"render",value:function(){var e=this.props,t=e.panel,n=e.timeInfo,r=e.scopedVars,o=e.error,i=e.isFullscreen,s=e.isLoading,u=this.state.menuItems,l=m.b.replaceWithText(t.title,r),d=c()({"panel-header":!0,"grid-drag-handle":!i});return a.a.createElement(a.a.Fragment,null,s&&this.renderLoadingState(),a.a.createElement("div",{className:d},a.a.createElement(j,{panel:t,title:t.title,description:t.description,scopedVars:t.scopedVars,links:Object(M.c)(t),error:o}),a.a.createElement("div",{className:"panel-title-container",onClick:this.onMenuToggle,onMouseDown:this.onMouseDown,"aria-label":f.a.pages.Dashboard.Panels.Panel.selectors.title(l)},a.a.createElement("div",{className:"panel-title"},a.a.createElement("span",{className:"icon-gf panel-alert-icon"}),a.a.createElement("span",{className:"panel-title-text"},l," ",a.a.createElement("span",{className:"fa fa-caret-down panel-menu-toggle"})),this.state.panelMenuOpen&&a.a.createElement(p.ClickOutsideWrapper,{onClick:this.closeMenu},a.a.createElement(N,{items:u})),n&&a.a.createElement("span",{className:"panel-time-info"},a.a.createElement("i",{className:"fa fa-clock-o"})," ",n)))))}}])&&z(n.prototype,r),o&&z(n,o),t}(o.Component),G=n("T9PE"),$=n("kHZm"),J=n("eXZ6");function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ie=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=re(this,oe(t).call(this,e))).timeSrv=Object(h.a)(),n.onRefresh=function(){var e=n.props,t=e.panel,r=e.isInView,o=e.width;if(!r)return console.log("Refresh when panel is visible",t.id),void n.setState({refreshWhenInView:!0});var a=Object(q.a)(t,n.timeSrv.timeRange());if(n.wantsQueryExecution){if(o<0)return void console.log("Refresh skippted, no width yet... wait till we know");var i=t.getQueryRunner();n.querySubscription||(n.querySubscription=i.getData().subscribe({next:function(e){return n.onDataUpdate(e)}})),i.run({datasource:t.datasource,queries:t.targets,panelId:t.id,dashboardId:n.props.dashboard.id,timezone:n.props.dashboard.getTimezone(),timeRange:a.timeRange,timeInfo:a.timeInfo,widthPixels:o,maxDataPoints:t.maxDataPoints,minInterval:t.interval,scopedVars:t.scopedVars,cacheTimeout:t.cacheTimeout,transformations:t.transformations})}},n.onRender=function(){var e={renderCounter:n.state.renderCounter+1};n.setState(e)},n.onOptionsChange=function(e){n.props.panel.updateOptions(e)},n.replaceVariables=function(e,t,r){var o=n.props.panel.scopedVars;return t&&(o=o?ee({},o,{},t):t),m.b.replace(e,o,r)},n.onPanelError=function(e){n.state.errorMessage!==e&&n.setState({errorMessage:e})},n.panelHasLastResult=function(){return!!n.props.panel.getQueryRunner().getLastResult()},n.onChangeTimeRange=function(e){n.timeSrv.setTime({from:Object(d.toUtc)(e.from),to:Object(d.toUtc)(e.to)})},n.state={isFirstLoad:!0,renderCounter:0,refreshWhenInView:!1,data:{state:d.LoadingState.NotStarted,series:[],timeRange:d.DefaultTimeRange}},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.panel,r=t.dashboard,o=t.isInEditMode;n.events.on(d.PanelEvents.refresh,this.onRefresh),n.events.on(d.PanelEvents.render,this.onRender),r.panelInitialized(this.props.panel),this.hasPanelSnapshot?this.setState({data:ee({},this.state.data,{state:d.LoadingState.Done,series:Object($.a)(n.snapshotData)}),isFirstLoad:!1}):(o&&(this.querySubscription=n.getQueryRunner().getData().subscribe({next:function(t){return e.onDataUpdate(t)}})),this.wantsQueryExecution||this.setState({isFirstLoad:!1}))}},{key:"componentWillUnmount",value:function(){this.props.panel.events.off(d.PanelEvents.refresh,this.onRefresh),this.props.panel.events.off(d.PanelEvents.render,this.onRender),this.querySubscription&&this.querySubscription.unsubscribe()}},{key:"componentDidUpdate",value:function(e){var t=this.props.isInView;t!==e.isInView&&t&&this.state.refreshWhenInView&&this.onRefresh()}},{key:"onDataUpdate",value:function(e){if(this.props.isInView){var t,n=this.state.isFirstLoad;switch(e.state){case d.LoadingState.Loading:if(this.state.data.state===d.LoadingState.Loading)return;break;case d.LoadingState.Error:var r=e.error;r&&t!==r.message&&(t=r.message);break;case d.LoadingState.Done:this.props.dashboard.snapshot&&(this.props.panel.snapshotData=e.series.map((function(e){return Object(d.toDataFrameDTO)(e)}))),n&&(n=!1)}this.setState({isFirstLoad:n,errorMessage:t,data:e})}}},{key:"renderPanel",value:function(e,t){var n=this.props,r=n.panel,o=n.plugin,i=this.state,s=i.renderCounter,u=i.data,l=i.isFirstLoad,p=L.b.theme,f=u.state;if(f===d.LoadingState.Done&&G.a.renderingCompleted(),l&&(f===d.LoadingState.Loading||f===d.LoadingState.NotStarted))return null;var b=o.panel,m=u.timeRange||this.timeSrv.timeRange(),h=this.hasOverlayHeader()?0:p.panelHeaderHeight,y=o.noPadding?0:p.panelPadding,g=e-2*y-J.i,v=t-h-2*y-J.i,O=c()({"panel-content":!0,"panel-content--no-padding":o.noPadding});return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:O},a.a.createElement(b,{id:r.id,data:u,timeRange:m,timeZone:this.props.dashboard.getTimezone(),options:r.getOptions(),transparent:r.transparent,width:g,height:v,renderCounter:s,replaceVariables:this.replaceVariables,onOptionsChange:this.onOptionsChange,onChangeTimeRange:this.onChangeTimeRange})))}},{key:"hasOverlayHeader",value:function(){var e=this.props.panel,t=this.state,n=t.errorMessage,r=t.data;return!(n||r.request&&r.request.timeInfo||e.hasTitle())}},{key:"render",value:function(){var e=this,t=this.props,n=t.dashboard,r=t.panel,o=t.isFullscreen,i=t.width,s=t.height,u=this.state,l=u.errorMessage,f=u.data,b=r.transparent,m=c()({"panel-container":!0,"panel-container--absolute":!0,"panel-container--transparent":b,"panel-container--no-title":this.hasOverlayHeader()});return a.a.createElement("div",{className:m},a.a.createElement(X,{panel:r,dashboard:n,timeInfo:f.request?f.request.timeInfo:void 0,title:r.title,description:r.description,scopedVars:r.scopedVars,links:r.links,error:l,isFullscreen:o,isLoading:f.state===d.LoadingState.Loading}),a.a.createElement(p.ErrorBoundary,null,(function(t){var n=t.error;return n?(e.onPanelError(n.message||"Error in plugin"),null):e.renderPanel(i,s)})))}},{key:"hasPanelSnapshot",get:function(){var e=this.props.panel;return e.snapshotData&&e.snapshotData.length}},{key:"wantsQueryExecution",get:function(){return!(this.props.plugin.meta.skipDataQuery||this.hasPanelSnapshot)}}])&&ne(n.prototype,r),o&&ne(n,o),t}(o.PureComponent),ce=n("lubD"),se=n("GP+p"),ue=n("EGoX"),le=n("OG+f"),pe=n("9LhM"),fe=n("J4KJ");function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ge=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),me(this,he(t).call(this,e))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.loadAngularOptions()}},{key:"componentDidUpdate",value:function(e){this.props.plugin!==e.plugin&&this.cleanUpAngularOptions(),this.loadAngularOptions()}},{key:"componentWillUnmount",value:function(){this.cleanUpAngularOptions()}},{key:"cleanUpAngularOptions",value:function(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}},{key:"loadAngularOptions",value:function(){var e=this,t=this.props,n=t.panel,r=t.angularPanelComponent,o=t.changePanelPlugin;if(this.element&&r&&!this.angularOptions){var a=r.getScope();if(a.$$childHead){var i=a.$$childHead.ctrl;i.initEditMode(),i.onPluginTypeChange=function(e){o(n,e.id)};for(var c="",s=0;s<i.editorTabs.length;s++)c+='\n      <div class="panel-options-group" ng-cloak>'+(s>0?'<div class="panel-options-group__header">\n           <span class="panel-options-group__title">{{ctrl.editorTabs['.concat(s,"].title}}\n           </span>\n         </div>"):"")+'<div class="panel-options-group__body">\n          <panel-editor-tab editor-tab="ctrl.editorTabs['.concat(s,']" ctrl="ctrl"></panel-editor-tab>\n        </div>\n      </div>\n      ');var u=Object(b.getAngularLoader)(),l={ctrl:i};this.angularOptions=u.load(this.element,l,c)}else setTimeout((function(){e.forceUpdate()}))}}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:function(t){return e.element=t}})}}])&&be(n.prototype,r),o&&be(n,o),t}(o.PureComponent),ve={changePanelPlugin:fe.b},Oe=Object(u.connect)((function(e,t){return{angularPanelComponent:e.dashboard.panels[t.panel.id].angularComponent}}),ve)(ge),Ee=n("EKT6");function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pe(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xe=function(e){function t(){return Se(this,t),Pe(this,ke(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.searchQuery,n=e.onChange,r=e.onClose;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ee.a,{labelClassName:"gf-form--has-input-icon",inputClassName:"gf-form-input width-13",placeholder:"",onChange:n,value:t,ref:function(e){return e&&e.focus()}}),a.a.createElement("button",{className:"btn btn-link toolbar__close",onClick:r},a.a.createElement("i",{className:"fa fa-chevron-up"})))}}])&&je(n.prototype,r),o&&je(n,o),t}(o.PureComponent),Te=n("7iUX");function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return!t||"object"!==_e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Re=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ne(this,Me(t).call(this,e))).getReactPanelOptions=function(){return n.props.panel.getOptions()},n.clearQuery=function(){n.setState({searchQuery:""})},n.onPanelOptionsChanged=function(e,t){n.props.panel.updateOptions(e),n.forceUpdate(t)},n.onOpenVizPicker=function(){n.setState({isVizPickerOpen:!0,scrollTop:0})},n.onCloseVizPicker=function(){n.props.urlOpenVizPicker&&n.props.updateLocation({query:{openVizPicker:null},partial:!0}),n.setState({isVizPickerOpen:!1,hasBeenFocused:!1})},n.onSearchQueryChange=function(e){n.setState({searchQuery:e})},n.renderToolbar=function(){var e=n.props.plugin,t=n.state,r=t.isVizPickerOpen,o=t.searchQuery,i=e.meta;return r?a.a.createElement(xe,{plugin:i,searchQuery:o,onChange:n.onSearchQueryChange,onClose:n.onCloseVizPicker}):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"toolbar__main",onClick:n.onOpenVizPicker},a.a.createElement("img",{className:"toolbar__main-image",src:i.info.logos.small}),a.a.createElement("div",{className:"toolbar__main-name"},i.name),a.a.createElement("i",{className:"fa fa-caret-down"})),a.a.createElement(Te.a,{state:i.state}))},n.onPluginTypeChange=function(e){e.id===n.props.plugin.meta.id?n.setState({isVizPickerOpen:!1}):n.props.onPluginTypeChange(e)},n.renderHelp=function(){return a.a.createElement(le.a,{plugin:n.props.plugin.meta,type:"help"})},n.setScrollTop=function(e){var t=e.target;n.setState({scrollTop:t.scrollTop})},n.state={isVizPickerOpen:n.props.urlOpenVizPicker,hasBeenFocused:!1,searchQuery:"",scrollTop:0,data:{state:d.LoadingState.NotStarted,series:[],timeRange:d.DefaultTimeRange}},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,e),n=t,(r=[{key:"renderPanelOptions",value:function(){var e=this.props,t=e.plugin,n=e.dashboard,r=e.panel;return t.angularPanelCtrl?a.a.createElement(Oe,{plugin:t,dashboard:n,panel:r}):t.editor?a.a.createElement(t.editor,{data:this.state.data,options:this.getReactPanelOptions(),onOptionsChange:this.onPanelOptionsChanged}):a.a.createElement("p",null,"Visualization has no options")}},{key:"componentDidMount",value:function(){var e=this,t=this.props.panel.getQueryRunner();this.querySubscription=t.getData().subscribe({next:function(t){return e.setState({data:t})}})}},{key:"componentWillUnmount",value:function(){this.querySubscription&&this.querySubscription.unsubscribe()}},{key:"render",value:function(){var e=this.props.plugin,t=this.state,n=t.isVizPickerOpen,r=t.searchQuery,o=t.scrollTop,i=e.meta,c={heading:"帮助",icon:"fa fa-question",render:this.renderHelp};return a.a.createElement(se.a,{heading:"Visualization",renderToolbar:this.renderToolbar,toolbarItems:[c],scrollTop:o,setScrollTop:this.setScrollTop},a.a.createElement(a.a.Fragment,null,a.a.createElement(pe.a,{in:n,duration:200,unmountOnExit:!0,onExited:this.clearQuery},a.a.createElement(ue.a,{current:i,onTypeChange:this.onPluginTypeChange,searchQuery:r,onClose:this.onCloseVizPicker})),this.renderPanelOptions()))}}])&&De(n.prototype,r),o&&De(n,o),t}(o.PureComponent),Le={updateLocation:I.c},qe=Object(u.connect)((function(e){return{urlOpenVizPicker:!!e.location.query.openVizPicker}}),Le)(Re),Ae=n("txxJ");var Fe=function(e){return Object.keys(e).reduce((function(t,n){return t.concat(n+"="+e[n])}),[]).join()},Ve=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.panelCtrl=t.ctrl;t.$watch((function(e){var t=e.ctrl.panel;return["title","description","transparent","repeat","repeatDirection","minSpan"].map((function(e){return e+"="+(t[e]&&t[e].toString?t[e].toString():t[e])})).join()+(t.links||[]).map(Fe).join()}),(function(){console.log("panel.render()"),n.panelCtrl.panel.render()}),!0)};Ve.$inject=["$scope"],Ve.$inject=["$scope"],Ae.c.directive("panelGeneralTab",(function(){return{restrict:"E",templateUrl:"public/app/features/panel/partials/general_tab.html",controller:Ve}}));var Qe=n("GkHB");function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t){return!t||"object"!==Ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ze(this,Be(t).call(this,e))).onDataLinksChanged=function(e,t){n.props.panel.links=e,n.props.panel.render(),n.forceUpdate(t)},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){if(this.element){var e=this.props.panel,t=Object(b.getAngularLoader)(),n={ctrl:{panel:e}};this.component=t.load(this.element,n,"<panel-general-tab />")}}},{key:"componentWillUnmount",value:function(){this.component&&this.component.destroy()}},{key:"render",value:function(){var e=this,t=this.props.panel,n=Object(Qe.d)();return a.a.createElement(se.a,{heading:"General",toolbarItems:[]},a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:function(t){return e.element=t}}),a.a.createElement(p.PanelOptionsGroup,{title:"Panel links"},a.a.createElement(p.DataLinksEditor,{value:t.links,onChange:this.onDataLinksChanged,suggestions:n,maxLinks:10}))))}}])&&He(n.prototype,r),o&&He(n,o),t}(o.PureComponent),Xe=n("t7Yz"),Ge=n("xL/7"),$e=n("I1OQ"),Je=n("Wwog"),Ke=Object(Je.a)((function(e,t){var n=t.tabs.length>0?t.tabs[0].id:Ge.a.Queries;return{activeTab:e.query.tab||n,tabs:t.tabs}}));function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ot=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=tt(this,nt(t).call(this,e))).refreshFromState=function(e){var t=n.props,r=t.refreshPanelEditor,o=t.plugin;r({hasQueriesTab:!(e=e||o.meta).skipDataQuery,usesGraphPlugin:"graph"===e.id,alertingEnabled:b.config.alertingEnabled})},n.onChangeTab=function(e){var t=n.props.changePanelEditorTab;setTimeout((function(){return t(e)}),10)},n.onPluginTypeChange=function(e){n.props.changePanelPlugin(n.props.panel,e.id),n.refreshFromState(e)},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.refreshFromState()}},{key:"componentWillUnmount",value:function(){(0,this.props.panelEditorCleanUp)()}},{key:"renderCurrentTab",value:function(e){var t=this.props,n=t.panel,r=t.dashboard,o=t.plugin;switch(e){case"advanced":return a.a.createElement(Ye,{panel:n});case"queries":return a.a.createElement(ce.a,{panel:n,dashboard:r});case"alert":return a.a.createElement(Xe.a,{dashboard:r,panel:n});case"visualization":return a.a.createElement(qe,{panel:n,dashboard:r,plugin:o,onPluginTypeChange:this.onPluginTypeChange});default:return null}}},{key:"render",value:function(){var e=this,t=this.props,n=t.activeTab,r=t.tabs;return a.a.createElement("div",{className:"panel-editor-container__editor"},a.a.createElement("div",{className:"panel-editor-tabs"},r.map((function(t){return a.a.createElement(ct,{tab:t,activeTab:n,onClick:e.onChangeTab,key:t.id})}))),a.a.createElement("div",{className:"panel-editor__right"},this.renderCurrentTab(n)))}}])&&et(n.prototype,r),o&&et(n,o),t}(o.PureComponent),at={refreshPanelEditor:$e.b,panelEditorCleanUp:Ge.c,changePanelEditorTab:$e.a,changePanelPlugin:fe.b},it=Object(u.connect)((function(e){return Ke(e.location,e.panelEditor)}),at)(ot);function ct(e){var t=e.tab,n=e.activeTab,r=e.onClick,o=c()({"panel-editor-tabs__link":!0,active:n===t.id});return a.a.createElement("div",{className:"panel-editor-tabs__item",onClick:function(){return r(t)}},a.a.createElement("a",{className:o,"aria-label":f.a.pages.Dashboard.Panels.EditPanel.selectors.tabItems(t.text)},a.a.createElement(p.Tooltip,{content:"".concat(t.text),placement:"auto"},a.a.createElement("i",{className:"gicon gicon-".concat(t.id).concat(n===t.id?"-active":"")}))))}var st=n("Nznp"),ut=n.n(st);function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ft(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ft(this,dt(t).call(this,e))).initialHeight=Math.floor(.3*document.documentElement.scrollHeight),n.noStyles={},n.changeHeight=function(e){var t=n.smallestHeight,r=n.largestHeight;e=(e=e<t?t:e)>r?r:e,n.prevEditorHeight=n.state.editorHeight,n.setState({editorHeight:e})},n.onDrag=function(e,t){var r=n.state.editorHeight+t.y;n.throttledChangeHeight(r)},n.state={editorHeight:n.initialHeight},n.throttledChangeHeight=Object(l.throttle)(n.changeHeight,20,{trailing:!0}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.render,n=e.isEditing,r=this.state.editorHeight;return a.a.createElement(a.a.Fragment,null,t(n?{height:r}:this.noStyles),n&&a.a.createElement("div",{className:"panel-editor-container__resizer"},a.a.createElement(ut.a,{axis:"y",grid:[100,1],onDrag:this.onDrag,position:{x:0,y:0}},a.a.createElement("div",{className:"panel-editor-resizer"},a.a.createElement("div",{className:"panel-editor-resizer__handle"})))))}},{key:"largestHeight",get:function(){return.9*document.documentElement.scrollHeight}},{key:"smallestHeight",get:function(){return 100}}])&&pt(n.prototype,r),o&&pt(n,o),t}(o.PureComponent),ht=n("KyLG");function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=vt(this,Ot(t).call(this,e))).element=null,n.timeSrv=Object(h.a)(),n.onPanelRenderEvent=function(e){var t=n.state.alertState;e&&e.alertState?n.setState({alertState:e.alertState}):e&&t?n.setState({alertState:void 0}):n.forceUpdate()},n.state={data:{state:d.LoadingState.NotStarted,series:[],timeRange:d.DefaultTimeRange}},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.panel;this.loadAngularPanel();var n=t.getQueryRunner();this.querySubscription=n.getData(!1).subscribe({next:function(t){return e.onPanelDataUpdate(t)}})}},{key:"subscribeToRenderEvent",value:function(){this.props.panel.events.on(d.PanelEvents.render,this.onPanelRenderEvent)}},{key:"onPanelDataUpdate",value:function(e){var t;if(e.state===d.LoadingState.Error){var n=e.error;n&&t!==n.message&&(t=n.message)}this.setState({data:e,errorMessage:t})}},{key:"componentWillUnmount",value:function(){this.cleanUpAngularPanel(),this.querySubscription&&this.querySubscription.unsubscribe(),this.props.panel.events.off(d.PanelEvents.render,this.onPanelRenderEvent)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.plugin,o=n.height,a=n.width,i=n.panel;e.plugin!==r&&(this.cleanUpAngularPanel(),this.loadAngularPanel()),e.width===a&&e.height===o||this.scopeProps&&(this.scopeProps.size.height=this.getInnerPanelHeight(),this.scopeProps.size.width=this.getInnerPanelWidth(),i.events.emit(d.PanelEvents.panelSizeChanged))}},{key:"getInnerPanelHeight",value:function(){var e=this.props,t=e.plugin,n=e.height,r=L.b.theme;return n-(this.hasOverlayHeader()?0:r.panelHeaderHeight)-2*(t.noPadding?0:r.panelPadding)-J.i}},{key:"getInnerPanelWidth",value:function(){var e=this.props,t=e.plugin,n=e.width,r=L.b.theme;return n-2*(t.noPadding?0:r.panelPadding)-J.i}},{key:"loadAngularPanel",value:function(){var e=this.props,t=e.panel,n=e.dashboard,r=e.setPanelAngularComponent;if(this.element){var o=Object(b.getAngularLoader)();this.scopeProps={panel:t,dashboard:n,size:{width:this.getInnerPanelWidth(),height:this.getInnerPanelHeight()}},r({panelId:t.id,angularComponent:o.load(this.element,this.scopeProps,'<plugin-component type="panel" class="panel-height-helper"></plugin-component>')}),this.subscribeToRenderEvent()}}},{key:"cleanUpAngularPanel",value:function(){var e=this.props,t=e.angularComponent,n=e.setPanelAngularComponent,r=e.panel;t&&t.destroy(),n({panelId:r.id,angularComponent:null})}},{key:"hasOverlayHeader",value:function(){var e=this.props.panel,t=this.state,n=t.errorMessage,r=t.data;return!(n||r.request&&r.request.timeInfo||e.hasTitle())}},{key:"render",value:function(){var e,t,n,r=this,o=this.props,i=o.dashboard,s=o.panel,u=o.isFullscreen,l=o.plugin,p=o.angularComponent,f=this.state,b=f.errorMessage,m=f.data,h=f.alertState,y=s.transparent,g=c()((e={"panel-container":!0,"panel-container--absolute":!0,"panel-container--transparent":y,"panel-container--no-title":this.hasOverlayHeader(),"panel-has-alert":void 0!==s.alert},t="panel-alert-state--".concat(h),n=void 0!==h,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),v=c()({"panel-content":!0,"panel-content--no-padding":l.noPadding});return a.a.createElement("div",{className:g},a.a.createElement(X,{panel:s,dashboard:i,timeInfo:m.request?m.request.timeInfo:void 0,title:s.title,description:s.description,scopedVars:s.scopedVars,angularComponent:p,links:s.links,error:b,isFullscreen:u,isLoading:m.state===d.LoadingState.Loading}),a.a.createElement("div",{className:v},a.a.createElement("div",{ref:function(e){return r.element=e},className:"panel-height-helper"})))}}])&&gt(n.prototype,r),o&&gt(n,o),t}(o.PureComponent),St={setPanelAngularComponent:ht.n},jt=Object(u.connect)((function(e,t){return{angularComponent:e.dashboard.panels[t.panel.id].angularComponent}}),St)(wt);function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e,t){return!t||"object"!==Pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xt(e){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return Nt}));var _t=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ct(this,xt(t).call(this,e))).specialPanels={},n.onMouseEnter=function(){n.props.dashboard.setPanelFocus(n.props.panel.id)},n.onMouseLeave=function(){n.props.dashboard.setPanelFocus(0)},n.state={isLazy:!e.isInView},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.props.initDashboardPanel(this.props.panel)}},{key:"componentDidUpdate",value:function(){this.state.isLazy&&this.props.isInView&&this.setState({isLazy:!1})}},{key:"renderPanel",value:function(e){var t=this.props,n=t.dashboard,r=t.panel,o=t.isFullscreen,i=t.isEditing,c=t.isInView,u=t.isInEditMode,l={height:i?"100%":""};return a.a.createElement(s.a,{style:l},(function(t){var i=t.width,s=t.height;return 0===i?null:e.angularPanelCtrl?a.a.createElement(jt,{plugin:e,panel:r,dashboard:n,isFullscreen:o,isInView:c,width:i,height:s}):a.a.createElement(ie,{plugin:e,panel:r,dashboard:n,isFullscreen:o,isInView:c,isInEditMode:u,width:i,height:s})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.panel,r=t.dashboard,o=t.isFullscreen,i=t.isEditing,s=t.plugin,u=this.state.isLazy;if(!s)return null;if(u)return null;var l=c()({"panel-editor-container":i,"panel-height-helper":!i}),p=c()({"panel-wrapper":!0,"panel-wrapper--edit":i,"panel-wrapper--view":o&&!i});return a.a.createElement("div",{className:l},a.a.createElement(mt,{isEditing:i,panel:n,render:function(t){return a.a.createElement("div",{className:p,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:t},e.renderPanel(s))}}),n.isEditing&&a.a.createElement(it,{panel:n,plugin:s,dashboard:r}))}}])&&kt(n.prototype,r),o&&kt(n,o),t}(o.PureComponent),Dt={initDashboardPanel:fe.e},Nt=Object(u.connect)((function(e,t){var n=e.dashboard.panels[t.panel.id];return n?{plugin:n.plugin}:{plugin:null}}),Dt)(_t)},kt0J:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("jYz7"),i=n("JEAp"),c=n("kDDq"),s=n("kDLi");function u(){var e=m(["\n      margin-bottom: ",";\n      padding: "," "," 0 ",";\n    "]);return u=function(){return e},e}function l(){var e=m(["\n      font-size: ",";\n    "]);return l=function(){return e},e}function p(){var e=m(["\n      cursor: pointer;\n      width: 25px;\n      height: 100%;\n      display: flex;\n      flex-shrink: 0;\n      justify-content: center;\n    "]);return p=function(){return e},e}function f(){var e=m(["\n      padding-left: ",";\n    "]);return f=function(){return e},e}function d(){var e=m(["\n      display: flex;\n      align-items: baseline;\n      justify-content: space-between;\n      margin: ",";\n    "]);return d=function(){return e},e}function b(){var e=m(["\n      background-color: ",";\n      z-index: 1;\n      flex-grow: 0;\n    "]);return b=function(){return e},e}function m(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var h=function(e){var t=e.tab,n=e.tabs,r=e.onSelectTab,a=e.onClose,i=e.onToggleExpand,c=e.panel,u=e.stats,l=e.isExpanded,p=Object(s.useTheme)(),f=y(p);return o.a.createElement("div",{className:f.header},o.a.createElement("div",{className:f.actions},o.a.createElement("div",{className:f.iconWrapper,onClick:i},o.a.createElement(s.Icon,{name:l?"chevron-right":"chevron-left",className:f.icon})),o.a.createElement("div",{className:f.iconWrapper,onClick:a},o.a.createElement(s.Icon,{name:"times",className:f.icon}))),o.a.createElement("div",{className:f.titleWrapper},o.a.createElement("h3",null,c.title),o.a.createElement("div",null,function(e){var t="".concat(e.queries," ").concat(1===e.queries?"query":"queries"),n="".concat(e.dataSources," ").concat(1===e.dataSources?"data source":"data sources"),r="".concat(-1===e.requestTime?"N/A":e.requestTime,"ms");return"".concat(t," - ").concat(n,"  - ").concat(r)}(u))),o.a.createElement(s.TabsBar,{className:f.tabsBar},n.map((function(e,n){return o.a.createElement(s.Tab,{key:"".concat(e.value,"-").concat(n),label:e.label,active:e.value===t,onChangeTab:function(){return r(e)}})}))))},y=Object(s.stylesFactory)((function(e){var t=Object(s.selectThemeVariant)({dark:e.colors.gray15,light:e.colors.white},e.type);return{header:Object(c.css)(b(),t),actions:Object(c.css)(d(),e.spacing.md),tabsBar:Object(c.css)(f(),e.spacing.md),iconWrapper:Object(c.css)(p()),icon:Object(c.css)(l(),e.typography.size.lg),titleWrapper:Object(c.css)(u(),e.spacing.lg,e.spacing.sm,e.spacing.sm,e.spacing.lg)}}));var g,v=n("t8hP"),O=n("Obii"),E=n("ZFWI");function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(){var e=x(["\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      width: 100%;\n    "]);return S=function(){return e},e}function j(){var e=x(["\n      height: calc(100% - 32px);\n    "]);return j=function(){return e},e}function P(){var e=x(["\n      margin-left: 16px;\n    "]);return P=function(){return e},e}function k(){var e=x(["\n      flex-grow: 2;\n    "]);return k=function(){return e},e}function C(){var e=x(["\n      display: flex;\n      margin: 8px 0;\n      justify-content: flex-end;\n      align-items: center;\n    "]);return C=function(){return e},e}function x(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function T(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return I})),function(e){e.Data="data",e.Request="request",e.Issue="issue",e.Meta="meta",e.Error="error",e.Stats="stats"}(g||(g={}));var I=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=D(this,N(t).call(this,e))).onDismiss=function(){Object(v.getLocationSrv)().update({query:{inspect:null,tab:null},partial:!0})},n.onToggleExpand=function(){n.setState((function(e){return{drawerWidth:"100%"===e.drawerWidth?"40%":"100%"}}))},n.onSelectTab=function(e){n.setState({tab:e.value||g.Data})},n.onSelectedFrameChanged=function(e){n.setState({selected:e.value||0})},n.exportCsv=function(e){var t=Object(O.toCSV)([e]),n=new Blob([t],{type:"application/csv;charset=utf-8"});Object(i.saveAs)(n,e.name+"-"+(new Date).getUTCDate()+".csv")},n.drawerHeader=function(){var e,t=n.state,r=t.tab,a=t.last,i=t.stats,c=null==a?void 0:a.error,s=[];return a&&(null==a?void 0:null===(e=a.series)||void 0===e?void 0:e.length)>0&&s.push({label:"Data",value:g.Data}),s.push({label:"Stats",value:g.Stats}),s.push({label:"Request",value:g.Request}),n.state.metaDS&&s.push({label:"Meta Data",value:g.Meta}),c&&c.message&&s.push({label:"Error",value:g.Error}),o.a.createElement(h,{tabs:s,tab:r,stats:i,onSelectTab:n.onSelectTab,onClose:n.onDismiss,panel:n.props.panel,onToggleExpand:n.onToggleExpand,isExpanded:"100%"===n.state.drawerWidth})},n.state={last:{},data:[],selected:0,tab:e.selectedTab||g.Data,drawerWidth:"50%",stats:{requestTime:0,queries:0,dataSources:0,processingTime:0}},n}var n,r,c,u,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(u=regeneratorRuntime.mark((function e(){var t,n,r,o,a,i,c,s,u,l,p,f,d,b,m,h,y,O,E,w,S,j,P,k,C,x,T,_,D;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.panel){e.next=4;break}return this.onDismiss(),e.abrupt("return");case 4:if(i=a.getQueryRunner().getLastResult()){e.next=8;break}return this.onDismiss(),e.abrupt("return");case 8:if(s=i.series,u=i.error,l=(null===(t=i.request)||void 0===t?void 0:t.targets)||[],p=(null===(n=i.request)||void 0===n?void 0:n.endTime)?(null===(r=i.request)||void 0===r?void 0:r.endTime)-i.request.startTime:-1,f=new Set(l.map((function(e){return e.datasource}))).size,d=(null===(o=i.timings)||void 0===o?void 0:o.dataProcessingTime)||-1,!s||!l.length){e.next=67;break}for(b={},m=!0,h=!1,y=void 0,e.prev=19,O=l[Symbol.iterator]();!(m=(E=O.next()).done);m=!0)w=E.value,b[w.refId]=w;e.next=27;break;case 23:e.prev=23,e.t0=e.catch(19),h=!0,y=e.t0;case 27:e.prev=27,e.prev=28,m||null==O.return||O.return();case 30:if(e.prev=30,!h){e.next=33;break}throw y;case 33:return e.finish(30);case 34:return e.finish(27);case 35:S=!0,j=!1,P=void 0,e.prev=38,k=s[Symbol.iterator]();case 40:if(S=(C=k.next()).done){e.next=53;break}if(x=C.value,!((T=b[x.refId])&&x.meta&&x.meta.custom)){e.next=50;break}return e.next=46,Object(v.getDataSourceSrv)().get(T.datasource);case 46:if(!((D=e.sent)&&(null===(_=D.components)||void 0===_?void 0:_.MetadataInspector))){e.next=50;break}return c=D,e.abrupt("break",53);case 50:S=!0,e.next=40;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(38),j=!0,P=e.t1;case 59:e.prev=59,e.prev=60,S||null==k.return||k.return();case 62:if(e.prev=62,!j){e.next=65;break}throw P;case 65:return e.finish(62);case 66:return e.finish(59);case 67:this.setState((function(e){return{last:i,data:s,metaDS:c,tab:u?g.Error:e.tab,stats:{requestTime:p,queries:l.length,dataSources:f,processingTime:d}}}));case 68:case"end":return e.stop()}}),e,this,[[19,23,27,35],[28,,30,34],[38,55,59,67],[60,,62,66]])})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=u.apply(e,t);function a(e){T(o,n,r,a,i,"next",e)}function i(e){T(o,n,r,a,i,"throw",e)}a(void 0)}))},function(){return l.apply(this,arguments)})},{key:"renderMetadataInspector",value:function(){var e,t=this.state,n=t.metaDS,r=t.data;return n&&(null===(e=n.components)||void 0===e?void 0:e.MetadataInspector)?o.a.createElement(n.components.MetadataInspector,{datasource:n,data:r}):o.a.createElement("div",null,"No Metadata Inspector")}},{key:"renderDataTab",value:function(){var e=this,t=this.state,n=t.data,r=t.selected,i=R();if(!n||!n.length)return o.a.createElement("div",null,"No Data");var c=n.map((function(e,t){return{value:t,label:"".concat(e.name," (").concat(t,")")}})),u=Object(O.applyFieldOverrides)({data:n,theme:E.a.theme,fieldOptions:{defaults:{},overrides:[]},replaceVariables:function(e){return e}});return o.a.createElement("div",{className:i.dataTabContent},o.a.createElement("div",{className:i.toolbar},c.length>1&&o.a.createElement("div",{className:i.dataFrameSelect},o.a.createElement(s.Select,{options:c,value:c.find((function(e){return e.value===r})),onChange:this.onSelectedFrameChanged})),o.a.createElement("div",{className:i.downloadCsv},o.a.createElement(s.Forms.Button,{variant:"primary",onClick:function(){return e.exportCsv(u[r])}},"Download CSV"))),o.a.createElement("div",{style:{flexGrow:1}},o.a.createElement(a.a,null,(function(e){var t=e.width,n=e.height;return 0===t?null:o.a.createElement("div",{style:{width:t,height:n}},o.a.createElement(s.Table,{width:t,height:n,data:u[r]}))}))))}},{key:"renderErrorTab",value:function(e){return e?e.data?o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,e.data.message),o.a.createElement(s.JSONFormatter,{json:e,open:2})):o.a.createElement("div",null,e.message):null}},{key:"renderRequestTab",value:function(){return o.a.createElement(s.JSONFormatter,{json:this.state.last,open:3})}},{key:"renderStatsTab",value:function(){var e=this.state.stats;return o.a.createElement("table",{className:"filter-table width-30"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,"Query time"),o.a.createElement("td",null,"".concat(-1===e.requestTime?"N/A":e.requestTime+"ms"))),o.a.createElement("tr",null,o.a.createElement("td",null,"Data processing time"),o.a.createElement("td",null,"".concat(-1===e.processingTime?"N/A":Math.round(100*(e.processingTime+Number.EPSILON))/100+"ms")))))}},{key:"render",value:function(){var e=this.state,t=e.last,n=e.tab,r=e.drawerWidth,a=R(),i=null==t?void 0:t.error;return o.a.createElement(s.Drawer,{title:this.drawerHeader,width:r,onClose:this.onDismiss},o.a.createElement(s.TabContent,{className:a.tabContent},o.a.createElement(s.CustomScrollbar,{autoHeightMin:"100%"},n===g.Data&&this.renderDataTab(),n===g.Meta&&this.renderMetadataInspector(),n===g.Request&&this.renderRequestTab(),n===g.Error&&this.renderErrorTab(i),n===g.Stats&&this.renderStatsTab())))}}])&&_(n.prototype,r),c&&_(n,c),t}(r.PureComponent),R=Object(s.stylesFactory)((function(){return{toolbar:Object(c.css)(C()),dataFrameSelect:Object(c.css)(k()),downloadCsv:Object(c.css)(P()),tabContent:Object(c.css)(j()),dataTabContent:Object(c.css)(S())}}))},lubD:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("GP+p"),i=n("Wkk1"),c=n("Xmxp"),s=n("ttS0"),u=n("kDLi"),l=n("GQ3c"),p=n("Obii");function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=y(this,g(t).call(this,e))).onPanelRefresh=function(){n.setState((function(e){return b({},e,{dsQuery:{isLoading:!0,response:{}}})}))},n.onRequestError=function(e){n.onDataSourceResponse(e)},n.onDataSourceResponse=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.state.isMocking?n.handleMocking(e):((e=b({},e)).headers&&delete e.headers,e.config&&(e.request=e.config,delete e.config,delete e.request.transformRequest,delete e.request.transformResponse,delete e.request.paramSerializer,delete e.request.jsonpCallbackParam,delete e.request.headers,delete e.request.requestId,delete e.request.inspect,delete e.request.retry,delete e.request.timeout),e.data&&(e.response=e.data,delete e.config,delete e.data,delete e.status,delete e.statusText,delete e.ok,delete e.url,delete e.redirected,delete e.type,delete e.$$config),n.setState((function(t){return b({},t,{dsQuery:{isLoading:!1,response:e}})})))},n.setFormattedJson=function(e){n.formattedJson=e},n.getTextForClipboard=function(){return JSON.stringify(n.formattedJson,null,2)},n.onClipboardSuccess=function(){c.b.emit(p.AppEvents.alertSuccess,["Content copied to clipboard"])},n.onToggleExpand=function(){n.setState((function(e){return b({},e,{allNodesExpanded:!n.state.allNodesExpanded})}))},n.onToggleMocking=function(){n.setState((function(e){return b({},e,{isMocking:!n.state.isMocking})}))},n.getNrOfOpenNodes=function(){return null===n.state.allNodesExpanded?3:n.state.allNodesExpanded?20:1},n.setMockedResponse=function(e){var t=e.target.value;n.setState((function(e){return b({},e,{mockedResponse:t})}))},n.renderExpandCollapse=function(){var e=n.state.allNodesExpanded,t=o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-minus-square-o"})," Collapse All"),r=o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-plus-square-o"})," Expand All");return e?t:r},n.state={allNodesExpanded:null,isMocking:!1,mockedResponse:"",dsQuery:{isLoading:!1,response:{}}},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.panel;c.b.on(l.CoreEvents.dsRequestResponse,this.onDataSourceResponse),c.b.on(l.CoreEvents.dsRequestError,this.onRequestError),e.events.on(p.PanelEvents.refresh,this.onPanelRefresh),e.refresh()}},{key:"componentWillUnmount",value:function(){var e=this.props.panel;c.b.off(l.CoreEvents.dsRequestResponse,this.onDataSourceResponse),c.b.on(l.CoreEvents.dsRequestError,this.onRequestError),e.events.off(p.PanelEvents.refresh,this.onPanelRefresh)}},{key:"handleMocking",value:function(e){var t,n=this.state.mockedResponse;try{t=JSON.parse(n)}catch(e){return void c.b.emit(p.AppEvents.alertError,["R: Failed to parse mocked response"])}e.data=t}},{key:"render",value:function(){var e=this.state.dsQuery,t=e.response,n=e.isLoading,r=this.getNrOfOpenNodes();return n?o.a.createElement(u.LoadingPlaceholder,{text:"Loading query inspector..."}):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"pull-right"},o.a.createElement("button",{className:"btn btn-transparent btn-p-x-0 m-r-1",onClick:this.onToggleExpand},this.renderExpandCollapse()),o.a.createElement(s.a,{className:"btn btn-transparent btn-p-x-0",text:this.getTextForClipboard,onSuccess:this.onClipboardSuccess},o.a.createElement("i",{className:"fa fa-clipboard"})," Copy to Clipboard")),o.a.createElement(u.JSONFormatter,{json:t,open:r,onDidRender:this.setFormattedJson}))}}])&&h(n.prototype,r),a&&h(n,a),t}(r.PureComponent),E=function(e){var t=e.label,n=e.placeholder,r=e.name,a=e.value,i=e.onBlur,c=e.onChange,s=e.tooltipInfo;return o.a.createElement("div",{className:"gf-form gf-form--flex-end"},o.a.createElement(u.FormLabel,{tooltip:s},t),o.a.createElement(u.Input,{type:"text",className:"gf-form-input width-6",placeholder:n,name:r,spellCheck:!1,onBlur:i,onChange:c,value:a}))};function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=T({},u.EventsWithValidation.onBlur,[{rule:function(e){return!e||p.rangeUtil.isValidTimeSpan(e)},errorMessage:"Not a valid timespan"}]),D=function(e){return""===e?null:e},N=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=k(this,C(t).call(this,e))).allOptions={cacheTimeout:{label:"Cache timeout",placeholder:"60",name:"cacheTimeout",tooltipInfo:o.a.createElement(o.a.Fragment,null,"If your time series store has a query cache this option can override the default cache timeout. Specify a numeric value in seconds.")},maxDataPoints:{label:"Max data points",placeholder:"auto",name:"maxDataPoints",tooltipInfo:o.a.createElement(o.a.Fragment,null,"The maximum data points the query should return. For graphs this is automatically set to one data point per pixel. For some data sources this can also be capped in the datasource settings page. With streaming data, this value is used for the rolling buffer.")},minInterval:{label:"Min time interval",placeholder:"0",name:"minInterval",panelKey:"interval",tooltipInfo:o.a.createElement(o.a.Fragment,null,"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example"," ",o.a.createElement("code",null,"1m")," if your data is written every minute. Access auto interval via variable"," ",o.a.createElement("code",null,"$__interval")," for time range string and ",o.a.createElement("code",null,"$__interval_ms")," for numeric variable that can be used in math expressions.")}},n.onRelativeTimeChange=function(e){n.setState({relativeTime:e.target.value})},n.onTimeShiftChange=function(e){n.setState({timeShift:e.target.value})},n.onOverrideTime=function(e,t){var r=e.target.value,o=n.props.panel,a=D(r);t===u.InputStatus.Valid&&o.timeFrom!==a&&(o.timeFrom=a,o.refresh())},n.onTimeShift=function(e,t){var r=e.target.value,o=n.props.panel,a=D(r);t===u.InputStatus.Valid&&o.timeShift!==a&&(o.timeShift=a,o.refresh())},n.onToggleTimeOverride=function(){var e=n.props.panel;n.setState({hideTimeOverride:!n.state.hideTimeOverride},(function(){e.hideTimeOverride=n.state.hideTimeOverride,e.refresh()}))},n.onDataSourceOptionBlur=function(e){return function(){var t=n.props.panel;t[e]=n.state[e],t.refresh()}},n.onDataSourceOptionChange=function(e){return function(t){n.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.state,T({},e,t.target.value)))}},n.renderOptions=function(){var e=n.props.datasource.meta.queryOptions||{};return Object.keys(n.allOptions).map((function(t){var r=n.allOptions[t],a=r.panelKey||t,i=n.state[a];return e[t]?o.a.createElement(E,S({key:t},r,{onChange:n.onDataSourceOptionChange(a),onBlur:n.onDataSourceOptionBlur(a),value:i})):null}))},n.state={relativeTime:e.panel.timeFrom||"",timeShift:e.panel.timeShift||"",cacheTimeout:e.panel.cacheTimeout||"",maxDataPoints:e.panel.maxDataPoints||"",interval:e.panel.interval||"",hideTimeOverride:e.panel.hideTimeOverride||!1},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.state.hideTimeOverride,t=this.state,n=t.relativeTime,r=t.timeShift;return o.a.createElement("div",{className:"gf-form-inline"},this.renderOptions(),o.a.createElement("div",{className:"gf-form"},o.a.createElement(u.FormLabel,null,"Relative time"),o.a.createElement(u.Input,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,validationEvents:_,hideErrorMessage:!0,value:n})),o.a.createElement("div",{className:"gf-form"},o.a.createElement("span",{className:"gf-form-label"},"Time shift"),o.a.createElement(u.Input,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,validationEvents:_,hideErrorMessage:!0,value:r})),(r||n)&&o.a.createElement("div",{className:"gf-form-inline"},o.a.createElement(u.Switch,{label:"Hide time info",checked:e,onChange:this.onToggleTimeOverride})))}}])&&P(n.prototype,r),a&&P(n,a),t}(r.PureComponent),M=n("LvDl"),I=n.n(M),R=n("O945"),L=n("bMS5");function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H=function(e){function t(){var e,n;A(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=V(this,(e=Q(t)).call.apply(e,[this].concat(o)))).onAddQuery=function(e){var t=n.props,r=t.queries;(0,t.onChangeQueries)(Object(L.a)(r,e)),n.props.onScrollBottom()},n.onRemoveQuery=function(e){var t=n.props,r=t.queries,o=t.onChangeQueries,a=t.panel;o(r.filter((function(t){return t!==e}))),a.refresh()},n.onMoveQuery=function(e,t){var r=n.props,o=r.queries,a=r.onChangeQueries,i=r.panel,c=I.a.indexOf(o,e);I.a.move(o,c,c+t),a(o),i.refresh()},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,e),n=t,(r=[{key:"onChangeQuery",value:function(e,t){var n=this.props,r=n.queries,o=n.onChangeQueries;e.refId=r[t].refId,o(r.map((function(n,r){return r===t?e:n})))}},{key:"render",value:function(){var e=this,t=this.props;return o.a.createElement("div",{className:"query-editor-rows"},t.queries.map((function(n,r){return o.a.createElement(R.a,{dataSourceValue:n.datasource||t.datasource.value,key:n.refId,panel:t.panel,dashboard:t.dashboard,data:t.data,query:n,onChange:function(t){return e.onChangeQuery(t,r)},onRemoveQuery:e.onRemoveQuery,onAddQuery:e.onAddQuery,onMoveQuery:e.onMoveQuery,inMixedMode:t.datasource.meta.mixed})})))}}])&&F(n.prototype,r),a&&F(n,a),t}(r.PureComponent),z=n("WnbS"),B=n("NXk7"),W=n("ZFWI"),Y=n("OG+f"),X=n("4RCQ"),G=n("exx3");function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return ne}));var ne=function(e){function t(){var e,n;J(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Z(this,(e=ee(t)).call.apply(e,[this].concat(a)))).datasources=Object(z.a)().getMetricSources(),n.backendSrv=B.b,n.state={isLoadingHelp:!1,currentDS:n.findCurrentDataSource(),helpContent:null,isPickerOpen:!1,isAddingMixed:!1,scrollTop:0,data:{state:p.LoadingState.NotStarted,series:[],timeRange:p.DefaultTimeRange}},n.onChangeDataSource=function(e){var t=n.props.panel,r=n.state.currentDS;if(e.meta.mixed)t.targets.forEach((function(e){e.datasource!==G.a&&(e.datasource=t.datasource,e.datasource||(e.datasource=W.b.defaultDatasource))}));else if(r)if(r.meta.mixed){var o=!0,a=!1,i=void 0;try{for(var c,s=t.targets[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u.datasource!==G.a&&delete u.datasource}}catch(e){a=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw i}}}else r.meta.id!==e.meta.id&&(t.targets=[{refId:"A"}]);t.datasource=e.value,t.refresh(),n.setState({currentDS:e})},n.renderQueryInspector=function(){var e=n.props.panel;return o.a.createElement(O,{panel:e})},n.renderHelp=function(){return o.a.createElement(Y.a,{plugin:n.state.currentDS.meta,type:"query_help"})},n.onUpdateQueries=function(e){n.props.panel.targets=e,n.forceUpdate()},n.onAddQueryClick=function(){n.state.currentDS.meta.mixed?n.setState({isAddingMixed:!0}):(n.onUpdateQueries(Object(L.a)(n.props.panel.targets)),n.onScrollBottom())},n.onAddExpressionClick=function(){n.onUpdateQueries(Object(L.a)(n.props.panel.targets,G.b.newQuery())),n.onScrollBottom()},n.onScrollBottom=function(){n.setState({scrollTop:n.state.scrollTop+1e4})},n.renderToolbar=function(){var e=n.state,t=e.currentDS,r=e.isAddingMixed,a=!(r||Object(X.b)(t.name));return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.a,{datasources:n.datasources,onChange:n.onChangeDataSource,current:t}),o.a.createElement("div",{className:"flex-grow-1"}),a&&o.a.createElement("button",{className:"btn navbar-button",onClick:n.onAddQueryClick},"添加查询"),r&&n.renderMixedPicker(),W.b.featureToggles.expressions&&o.a.createElement("button",{className:"btn navbar-button",onClick:n.onAddExpressionClick},"Add Expression"))},n.renderMixedPicker=function(){var e=n.datasources.filter((function(e){return"mixed"!==e.meta.id}));return o.a.createElement(i.a,{datasources:e,onChange:n.onAddMixedQuery,current:null,autoFocus:!0,onBlur:n.onMixedPickerBlur,openMenuOnFocus:!0})},n.onAddMixedQuery=function(e){n.props.panel.targets=Object(L.a)(n.props.panel.targets,{datasource:e.name}),n.setState({isAddingMixed:!1,scrollTop:n.state.scrollTop+1e4}),n.forceUpdate()},n.onMixedPickerBlur=function(){n.setState({isAddingMixed:!1})},n.onQueryChange=function(e,t){n.props.panel.changeQuery(e,t),n.forceUpdate()},n.setScrollTop=function(e){var t=e.target;n.setState({scrollTop:t.scrollTop})},n.renderQueryBody=function(){var e=n.props,t=e.panel,r=e.dashboard,a=n.state,i=a.currentDS,c=a.data;return Object(X.b)(i.name)?o.a.createElement(X.a,{panel:t,panelData:c,onChange:function(e){return n.onUpdateQueries([e])}}):o.a.createElement(o.a.Fragment,null,o.a.createElement(H,{queries:t.targets,datasource:i,onChangeQueries:n.onUpdateQueries,onScrollBottom:n.onScrollBottom,panel:t,dashboard:r,data:c}),o.a.createElement(u.PanelOptionsGroup,null,o.a.createElement(N,{panel:t,datasource:i})))},n}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.panel.getQueryRunner();this.querySubscription=t.getData(!1).subscribe({next:function(t){return e.onPanelDataUpdate(t)}})}},{key:"componentWillUnmount",value:function(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}},{key:"onPanelDataUpdate",value:function(e){this.setState({data:e})}},{key:"findCurrentDataSource",value:function(){var e=this.props.panel;return this.datasources.find((function(t){return t.value===e.datasource}))||this.datasources[0]}},{key:"render",value:function(){var e=this.state.scrollTop,t={title:"Query Inspector",render:this.renderQueryInspector},n={heading:"帮助",icon:"fa fa-question",render:this.renderHelp};return o.a.createElement(a.a,{heading:"Query",renderToolbar:this.renderToolbar,toolbarItems:[t,n],setScrollTop:this.setScrollTop,scrollTop:e},o.a.createElement(o.a.Fragment,null,this.renderQueryBody()))}}])&&K(n.prototype,r),c&&K(n,c),t}(r.PureComponent)},t7Yz:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("/MKj"),i=n("kDDq"),c=n("kDLi"),s=n("t8hP"),u=n("Xmxp"),l=n("2nhE"),p=n("GP+p"),f=n("QQVG"),d=n("3ulR"),b=n("GQ3c");function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){var e,n;h(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=g(this,(e=v(t)).call.apply(e,[this].concat(o)))).state={stateHistoryItems:[]},n.clearHistory=function(){var e=n.props,t=e.dashboard,r=e.onRefresh,o=e.panelId;u.b.emit(b.CoreEvents.showConfirmModal,{title:"Delete Alert History",text:"Are you sure you want to remove all history & annotations for this alert?",icon:"fa-trash",yesText:"Yes",onConfirm:function(){Object(s.getBackendSrv)().post("/api/annotations/mass-delete",{dashboardId:t.id,panelId:o}).then((function(){n.setState({stateHistoryItems:[]}),r()}))}})},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.dashboard,r=t.panelId;Object(s.getBackendSrv)().get("/api/annotations?dashboardId=".concat(n.id,"&panelId=").concat(r,"&limit=50&type=alert"),{},"state-history-".concat(n.id,"-").concat(r)).then((function(t){var r=t.map((function(e){return{stateModel:d.a.getStateDisplayModel(e.newState),time:n.formatDate(e.time,"MMM D, YYYY HH:mm:ss"),info:d.a.getAlertAnnotationInfo(e)}}));e.setState({stateHistoryItems:r})}))}},{key:"render",value:function(){var e=this.state.stateHistoryItems;return o.a.createElement("div",null,e.length>0&&o.a.createElement("div",{className:"p-b-1"},o.a.createElement("span",{className:"muted"},"Last 50 state changes"),o.a.createElement("button",{className:"btn btn-small btn-danger pull-right",onClick:this.clearHistory},o.a.createElement("i",{className:"fa fa-trash"})," "," Clear history")),o.a.createElement("ol",{className:"alert-rule-list"},e.length>0?e.map((function(e,t){return o.a.createElement("li",{className:"alert-rule-item",key:"".concat(e.time,"-").concat(t)},o.a.createElement("div",{className:"alert-rule-item__icon ".concat(e.stateModel.stateClass)},o.a.createElement("i",{className:e.stateModel.iconClass})),o.a.createElement("div",{className:"alert-rule-item__body"},o.a.createElement("div",{className:"alert-rule-item__header"},o.a.createElement("p",{className:"alert-rule-item__name"},e.alertName),o.a.createElement("div",{className:"alert-rule-item__text"},o.a.createElement("span",{className:"".concat(e.stateModel.stateClass)},e.stateModel.text))),e.info),o.a.createElement("div",{className:"alert-rule-item__time"},e.time))})):o.a.createElement("i",null,"No state changes recorded")))}}])&&y(n.prototype,r),a&&y(n,a),t}(r.PureComponent),w=(n("eK0o"),n("ttS0")),S=n("Obii");function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(){var e,n;T(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=D(this,(e=N(t)).call.apply(e,[this].concat(a)))).state={isLoading:!1,allNodesExpanded:null,testRuleResponse:{}},n.setFormattedJson=function(e){n.formattedJson=e},n.getTextForClipboard=function(){return JSON.stringify(n.formattedJson,null,2)},n.onClipboardSuccess=function(){u.b.emit(S.AppEvents.alertSuccess,["Content copied to clipboard"])},n.onToggleExpand=function(){n.setState((function(e){return C({},e,{allNodesExpanded:!n.state.allNodesExpanded})}))},n.getNrOfOpenNodes=function(){return null===n.state.allNodesExpanded?3:n.state.allNodesExpanded?20:1},n.renderExpandCollapse=function(){var e=n.state.allNodesExpanded,t=o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-minus-square-o"})," Collapse All"),r=o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-plus-square-o"})," Expand All");return e?t:r},n}var n,r,a,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.testRule()}},{key:"testRule",value:(i=regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.panelId,r=t.dashboard,o={dashboard:r.getSaveModelClone(),panelId:n},this.setState({isLoading:!0}),e.next=5,Object(s.getBackendSrv)().post("/api/alerts/test",o);case 5:a=e.sent,this.setState({isLoading:!1,testRuleResponse:a});case 7:case"end":return e.stop()}}),e,this)})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){P(o,n,r,a,c,"next",e)}function c(e){P(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return l.apply(this,arguments)})},{key:"render",value:function(){var e=this.state,t=e.testRuleResponse;if(!0===e.isLoading)return o.a.createElement(c.LoadingPlaceholder,{text:"Evaluating rule"});var n=this.getNrOfOpenNodes();return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"pull-right"},o.a.createElement("button",{className:"btn btn-transparent btn-p-x-0 m-r-1",onClick:this.onToggleExpand},this.renderExpandCollapse()),o.a.createElement(w.a,{className:"btn btn-transparent btn-p-x-0",text:this.getTextForClipboard,onSuccess:this.onClipboardSuccess},o.a.createElement("i",{className:"fa fa-clipboard"})," Copy to Clipboard")),o.a.createElement(c.JSONFormatter,{json:t,open:n,onDidRender:this.setFormattedJson}))}}])&&_(n.prototype,r),a&&_(n,a),t}(r.PureComponent),R=n("xL/7"),L=n("I1OQ");function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function F(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n          width: 508px;\n          margin: 128px auto;\n        "]);return F=function(){return e},e}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return Y}));var B=function(e){function t(){var e,n;V(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=U(this,(e=H(t)).call.apply(e,[this].concat(a)))).state={validatonMessage:""},n.onAngularPanelUpdated=function(){n.forceUpdate()},n.stateHistory=function(){return{title:"State history",render:function(){return o.a.createElement(E,{dashboard:n.props.dashboard,panelId:n.props.panel.id,onRefresh:n.panelCtrl.refresh})}}},n.deleteAlert=function(){var e=n.props.panel;return{title:"删除",btnType:"danger",onClick:function(){u.b.emit(b.CoreEvents.showConfirmModal,{title:"删除告警",text:"是否确实要删除此告警规则?",text2:"您需要保存仪表盘，以便删除生效",icon:"fa-trash",yesText:"删除",onConfirm:function(){delete e.alert,e.thresholds=[],n.panelCtrl.alertState=null,n.panelCtrl.render(),n.forceUpdate()}})}}},n.renderTestRuleResult=function(){var e=n.props,t=e.panel,r=e.dashboard;return o.a.createElement(I,{panelId:t.id,dashboard:r})},n.testRule=function(){return{title:"Test Rule",render:function(){return n.renderTestRuleResult()}}},n.onAddAlert=function(){n.panelCtrl._enableAlert(),n.component.digest(),n.forceUpdate()},n.switchToQueryTab=function(){(0,n.props.changePanelEditorTab)(Object(R.b)(R.a.Queries))},n.renderValidationMessage=function(){var e=n.state.validatonMessage;return o.a.createElement("div",{className:Object(i.css)(F())},o.a.createElement("h2",null,e),o.a.createElement("br",null),o.a.createElement("div",{className:"gf-form-group"},o.a.createElement(c.Button,{size:"md",variant:"secondary",icon:"fa fa-arrow-left",onClick:n.switchToQueryTab},"返回查询")))},n}var n,r,a,d,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.loadAlertTab()}},{key:"componentDidUpdate",value:function(e){this.loadAlertTab()}},{key:"componentWillUnmount",value:function(){this.component&&this.component.destroy()}},{key:"loadAlertTab",value:(d=regeneratorRuntime.mark((function e(){var t,n,r,o,a,i,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.panel,r=t.angularPanelComponent,this.element&&r&&!this.component){e.next=3;break}return e.abrupt("return");case 3:if((o=r.getScope()).$$childHead){e.next=7;break}return setTimeout((function(){u.forceUpdate()})),e.abrupt("return");case 7:return this.panelCtrl=o.$$childHead.ctrl,a=Object(s.getAngularLoader)(),i={ctrl:this.panelCtrl},this.component=a.load(this.element,i,"<alert-tab />"),e.next=14,Object(l.a)(n.transformations,n.targets,Object(s.getDataSourceSrv)(),n.datasource);case 14:(c=e.sent)&&this.setState({validatonMessage:c});case 16:case"end":return e.stop()}}),e,this)})),m=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=d.apply(e,t);function a(e){A(o,n,r,a,i,"next",e)}function i(e){A(o,n,r,a,i,"throw",e)}a(void 0)}))},function(){return m.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props.panel,n=t.alert,r=t.transformations,a=this.state.validatonMessage,i=r&&r.length>0;if(!n&&a)return this.renderValidationMessage();var s=n?[this.stateHistory(),this.testRule(),this.deleteAlert()]:[],u={title:"面板未定义告警规则",buttonIcon:"gicon gicon-alert",onClick:this.onAddAlert,buttonTitle:"创建告警"};return o.a.createElement(p.a,{heading:"Alert",toolbarItems:s},o.a.createElement(o.a.Fragment,null,n&&i&&o.a.createElement(c.Alert,{severity:b.AppNotificationSeverity.Error,title:"Transformations are not supported in alert queries"}),o.a.createElement("div",{ref:function(t){return e.element=t}}),!n&&!a&&o.a.createElement(f.a,u)))}}])&&Q(n.prototype,r),a&&Q(n,a),t}(r.PureComponent),W={changePanelEditorTab:L.a},Y=Object(a.connect)((function(e,t){return{angularPanelComponent:e.dashboard.panels[t.panel.id].angularComponent}}),W)(B)}}]);
//# sourceMappingURL=default~DashboardPage~SoloPanelPage.5c3edd1990e1c7cf41f1.js.map